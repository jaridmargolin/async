!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).Async={})}(this,(function(t){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function i(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?a(t):e}var f,_=function(){function t(n){e(this,t),r(this,"_promise",void 0),this._promise=new Promise(n)}return i(t,[{key:"then",value:function(t,e){return this._promise.then(t,e)}},{key:"catch",value:function(t){return this._promise.catch(t)}},{key:"finally",value:function(t){return this._promise.finally(t)}}]),t}(),l=function(t){function n(){var t;e(this,n);var i=function(){},s=function(){};return r(a(t=c(this,u(n).call(this,(function(t,e){i=t,s=e})))),"_resolve",void 0),r(a(t),"_reject",void 0),t._resolve=i,t._reject=s,t}return s(n,t),i(n,[{key:"resolve",value:function(t){this._resolve(t)}},{key:"reject",value:function(t){this._reject(t)}}]),n}(_);(f=t.EventListenerStatus||(t.EventListenerStatus={}))[f.PENDING=0]="PENDING",f[f.RESOLVED=1]="RESOLVED",f[f.REJECTED=2]="REJECTED";var v,h=function(n){function o(n,i){var s;e(this,o);var f=function(){},_=function(){};return r(a(s=c(this,u(o).call(this,(function(t,e){f=t,_=e})))),"_status",void 0),r(a(s),"_resolve",void 0),r(a(s),"_reject",void 0),r(a(s),"_target",void 0),r(a(s),"_event",void 0),r(a(s),"_onEvent",void 0),s._resolve=f,s._reject=_,s._target=n,s._event=i,s._onEvent=function(e){s._status=t.EventListenerStatus.RESOLVED,s._target.off(s._event,s._onEvent),s._resolve(e)},s._status=t.EventListenerStatus.PENDING,s._target.on(s._event,s._onEvent),s}return s(o,n),i(o,null,[{key:"create",value:function(t,e){return new o(t,e)}}]),i(o,[{key:"cancel",value:function(e){this._status=t.EventListenerStatus.REJECTED,this._target.off(this._event,this._onEvent),this._reject(e)}}]),o}(_);(v=t.TimerStatus||(t.TimerStatus={}))[v.READY=0]="READY",v[v.STARTED=1]="STARTED",v[v.PAUSED=2]="PAUSED",v[v.STOPPED=3]="STOPPED",v[v.COMPLETED=4]="COMPLETED";var E=function(n){function o(n){var i;e(this,o);var s=function(){},f=function(){};return r(a(i=c(this,u(o).call(this,(function(t,e){s=t,f=e})))),"_state",void 0),r(a(i),"_resolve",void 0),r(a(i),"_reject",void 0),i._resolve=s,i._reject=f,i._state={status:t.TimerStatus.READY,duration:n},i}return s(o,n),i(o,null,[{key:"create",value:function(t){return new o(t)}}]),i(o,[{key:"set",value:function(e){return this._state.status===t.TimerStatus.STARTED&&(this.pause(),Object.assign(this._state,{duration:e}),this.start()),this._state.status!==t.TimerStatus.READY&&this._state.status!==t.TimerStatus.PAUSED||Object.assign(this._state,{duration:e}),this}},{key:"start",value:function(){var e=this;return this._state.status!==t.TimerStatus.READY&&this._state.status!==t.TimerStatus.PAUSED||(this._state={status:t.TimerStatus.STARTED,start:Date.now(),duration:this._state.duration,timeout:setTimeout((function(){e._state={status:t.TimerStatus.COMPLETED,duration:null},e._resolve()}),this._state.duration)}),this}},{key:"pause",value:function(){if(this._state.status===t.TimerStatus.STARTED){var e=Date.now()-this._state.start;clearTimeout(this._state.timeout),this._state={status:t.TimerStatus.PAUSED,duration:this._state.duration-e}}return this}},{key:"stop",value:function(e){return this._state.status===t.TimerStatus.STARTED&&clearTimeout(this._state.timeout),this._state={status:t.TimerStatus.STOPPED,duration:null},e&&this._reject(e),this}}]),o}(_);t.Deferred=l,t.EventListener=h,t.Promise=_,t.Timer=E,Object.defineProperty(t,"__esModule",{value:!0})}));
